开始的比较晚，大概前天才开始，进度落后不少

### Project1

利用`engine_util`中实现的函数，来填充`standalone_storage.go`中的函数

之后用实现的接口去实现`raw_api.go`

一开始写的时候在函数内部调用了`server.storage.start`和`server.storage.close`.但是结果不对，想了一下这个应该在函数外部调用.不是功能的一部分

遇到的主要困难是不熟悉GO语言,写代码效率很低,需要慢慢熟悉

### Project2

#### 2A

 - Raftlog中的index包括了storage中的和entries中的，是共用的index,所以访问entries中的数据时需要根据index和firstindex等计算出正确的下标

 - 一开始commit在handleAppendEntriesResponse时处理的，但是这样单个节点时无法更新commit,就特殊处理了一下,在sendAppend2All中处理了

 - newRaft里初始化时还要用到HardState里的信息

 - 多轮选举,vote相关的数据没有清空,由于统计选票是否过半的操作是在响应voteResponse时实现的,残留的数据会影响下一轮的选举

#### 2B

- 报错` panic: find no region for 30203030303030303030`
    
    2A中newRaft初始化存在问题，`Prs` 必须从 `confState` 中取，不然根本不知道集群中有哪些 `peer`,更改后`panic`消失

- handleAppendEntries中的response中index没有完全初始化,2A中应当只包含正常返回的情况

- append之后还要更新peerstorage中的raftState数据,而且要记得`SetMeta`写进去

#### 2C

- `proposeRaftCommand`序列化和`HandleRaftReady`反序列化的时候两边类型没对上,序列化的是req,反序列化的是msg,一直panic,看了好久才发现

- kv/raftstore/peer_msg_handler.go:190 不知道为啥

#### 4B

- txn储存完所有的修改之后记得将修改写入storage

- `commit`中,两种情况下返回ERR:
    - 有lock,lock.Ts != txn.StartTS
    - 无lock,发生了回滚